image: node:alpine

cache:
  paths:
    - node_modules

variables:
  REACT_APP_WALLET_API_URL: "https://codeplay-wallet-service.herokuapp.com/api"

stages:
  - test
  - deploy
  - lint

lint:
  stage: lint
  script:
    - yarn install
    - yarn lint

test:
  stage: test
  variables:
    REACT_APP_WALLET_API_URL: "basePath"
  script:
    - yarn install
    - yarn test --coverage

pages:
  stage: deploy
  script:
    - yarn install
    - yarn build
    - rm -rf public
    - mv build public
  artifacts:
    paths:
      - public # mandatory, other folder won't work
  only:
    - master # or dev, the branch you want to publish
